@Plan:name("StoreTestPlan")

@Source(type = 'tcp', context='SmartHomeData',
@map(type='passThrough'))
define stream SmartHomeData (id string, value float, property bool, plugId int, householdId int, houseId int, currentTime string);

@Source(type = 'tcp', context='TestData',
@map(type='passThrough'))
define stream TestData (property bool);

@Store(type='rdbms', jdbc.url='jdbc:mysql://localhost:3306/dasdb', username='root', password='root',field.length='currentTime:100')
@PrimaryKey('id')
@Index('houseId')
define table SmartHomeTable (id string, value float, property bool, plugId int, householdId int, houseId int, currentTime string);

from SmartHomeData
insert into SmartHomeTable;

from TestData#window.length(1) join SmartHomeTable
on TestData.property==SmartHomeTable.property
select TestData.property as TestProperty, SmartHomeTable.houseId as houseId, SmartHomeTable.value as value
insert into IgnoreStream;
